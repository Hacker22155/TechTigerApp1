<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶≠‡ßü‡ßá‡¶∏ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f2f2f2;
            padding: 50px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
        }

        #response {
            margin-top: 20px;
            padding: 10px;
            background-color: #e7f7e7;
            border: 1px solid #d4f4d4;
            border-radius: 5px;
            font-size: 18px;
            animation: fadeIn 1s ease-out;
        }

        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        button.stop {
            background-color: #f44336;
        }

        button:hover {
            background-color: #45a049;
            transform: scale(1.1);
        }

        button.stop:hover {
            background-color: #e53935;
            transform: scale(1.1);
        }

        #mic-icon {
            font-size: 50px;
            cursor: pointer;
            margin-top: 30px;
            animation: micPulse 1.5s infinite ease-in-out;
        }

        .spinner {
            display: none;
            margin-top: 20px;
            font-size: 30px;
            animation: spin 1.5s linear infinite;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes micPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‡¶≠‡ßü‡ßá‡¶∏ ‡¶¶‡¶ø‡ßü‡ßá ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h1>
        <div id="response">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶∏‡¶¨‡ßá...</div>
        <button id="startBtn">‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <button id="stopBtn" class="stop" style="display: none;">‡¶∏‡ßç‡¶ü‡¶™</button>
        <i id="mic-icon" class="fa fa-microphone"></i>
        <div id="spinner" class="spinner">üîÑ</div> <!-- Spinner animation -->
    </div>

    <script>
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const responseDiv = document.getElementById('response');
        const micIcon = document.getElementById('mic-icon');
        const spinner = document.getElementById('spinner');

        let recognition;
        let isRecognizing = false;
        let query = '';

        // Load JSON data
        let data = {};
        fetch('https://hacker22155.github.io/TechTigerApp1/data.json')
            .then(response => response.json())
            .then(jsonData => {
                data = jsonData;
            })
            .catch(err => console.error("Error loading JSON file:", err));

        function initializeSpeechRecognition() {
            recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'bn-BD'; // ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶≠‡¶æ‡¶∑‡¶æ‡ßü
            recognition.continuous = true;
            recognition.interimResults = true;

            recognition.onstart = function () {
                isRecognizing = true;
                startBtn.disabled = true;
                stopBtn.style.display = 'inline-block';
                responseDiv.textContent = '‡¶∂‡ßã‡¶®‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';
                spinner.style.display = 'inline-block'; // Show spinner
            };

            recognition.onresult = function (event) {
                let currentQuery = '';
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    currentQuery += event.results[i][0].transcript;
                }
                responseDiv.textContent = '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®: ' + currentQuery;
                query = currentQuery;  // Update query with the latest input
            };

            recognition.onerror = function (event) {
                console.error(event.error);
                responseDiv.textContent = '‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶≠‡ßÅ‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§';
                stopRecognition();
            };

            recognition.onend = function () {
                if (isRecognizing) {
                    recognition.start();
                }
            };
        }

        function startRecognition() {
            if (!recognition) {
                initializeSpeechRecognition();
            }
            recognition.start();
        }

        function stopRecognition() {
            isRecognizing = false;
            recognition.stop();
            startBtn.disabled = false;
            stopBtn.style.display = 'none';
            spinner.style.display = 'none'; // Hide spinner
            processQuery(query);  // Process the final query after stopping
        }

        function processQuery(query) {
            responseDiv.textContent = '‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá...';
            searchJsonData(query);
        }

        function searchJsonData(query) {
            let found = false;

            // Check JSON data for matching
            for (let key in data) {
                if (data[key].toLowerCase().includes(query.toLowerCase())) {
                    responseDiv.textContent = data[key];  // Show the answer from JSON
                    speakAnswer(data[key]);
                    found = true;
                    break;
                }
            }

            if (!found) {
                responseDiv.textContent = '‡¶°‡¶æ‡¶ü‡¶æ‡¶§‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§';
                speakAnswer('‡¶°‡¶æ‡¶ü‡¶æ‡¶§‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§');
            }
        }

        function speakAnswer(answer) {
            const speechSynthesis = window.speechSynthesis;
            const utterance = new SpeechSynthesisUtterance(answer);
            utterance.lang = 'bn-BD'; // ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶≠‡¶æ‡¶∑‡¶æ‡ßü
            speechSynthesis.speak(utterance);
        }

        startBtn.addEventListener('click', startRecognition);
        stopBtn.addEventListener('click', stopRecognition);

        micIcon.addEventListener('click', function () {
            if (isRecognizing) {
                stopRecognition();
            } else {
                startRecognition();
            }
        });
    </script>

</body>
</html>
